#!/usr/bin/python3.5

import sh

def get_sessions():
    try:
        sessions = sh.tmux('list-sessions')
        sessions = [s.split(' ')[0][:-1] for s in sessions]
        return sessions
    except sh.ErrorReturnCode_1:
        return []


# setup GIS

if 'Hyperion' in get_sessions():
    print('Hyperion exists')
else:
    print('Creating Hyperion session')
    sh.tmux('new-session',
            '-d',
            '-c', '/mnt/Store/projects/tileoven',
            '-n', 'tileoven',
            '-s', 'Hyperion')
    sh.tmux('send', 'node index.js\n')

    sh.tmux('new-window',
            '-n', 'servers')
    sh.tmux('send', 'cd /mnt/Store/projects/hyperion/tiles/server\n')
    sh.tmux('send', 'node index.js\n')

    sh.tmux('split-window', '-v')
    sh.tmux('send', 'cd /mnt/Store/projects/hyperion/web\n')
    sh.tmux('send', 'gulp default watch\n')

    sh.tmux('new-window',
            '-n', 'main')
    sh.tmux('send', 'cd /mnt/Store/projects/hyperion\n')
    sh.tmux('send', 'git status\n')


# noise designer

if 'NoiseDes' in get_sessions():
    print('NoiseDes exists')
else:
    print('Creating NoiseDesigner session')
    sh.tmux('new-session',
            '-d',
            '-c', '/mnt/Store/projects/noisedesigner',
            '-n', 'servers',
            '-s', 'NoiseDes')
    sh.tmux('send', 'cd /mnt/Store/projects/noisedesigner\n')
    sh.tmux('send', 'gulp default watch\n')

    sh.tmux('new-window',
            '-n', 'noisedesigner')
    sh.tmux('send', 'cd /mnt/Store/projects/noisedesigner\n')
    sh.tmux('send', 'git status\n')

print('done')
print(get_sessions())
